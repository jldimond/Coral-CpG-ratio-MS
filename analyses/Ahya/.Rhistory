setwd("~/Documents/Projects/CpG ratio analyses/Pdam_cpg")
data<-read.delim("t5", header=F)
data2<-na.omit(data)
data3 <-subset(data2, V2 <= 3)
dencpg<-density(data3$V2, na.rm=T)
pdf("PdamCpGDensity")
plot(dencpg, xlim=c(-0.1,1.7))
dev.off()
GOslim<-tapply(data3$V2, data3$V4, mean)
pdf("PdamGOslim")
par(mar=c(5,15,4,2))
barplot(GOslim, xlim=c(0.5,0.8),xpd=F, horiz=TRUE, las=2)
dev.off()
View(data)
setwd("~/Documents/Projects/CpG ratio analyses/past_cpg")
data<-read.delim("past_cpg_goslim_tab", header=T)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
data2<-as.numeric.factor(x=data$Column2)
data3<-cbind(data2, data)
data4<-na.omit(data3)
data5 <-subset(data4, data2 <= 3)
dencpg<-density(data5$data2, na.rm=T)
pdf("PastCpGDensity")
plot(dencpg, xlim=c(-0.1,1.7))
dev.off()
GOslim<-tapply(data5$data2, data5$GOSlim_bin, mean)
pdf("PastGOslim")
par(mar=c(5,15,4,2))
barplot(GOslim, xlim=c(0.5,0.8),xpd=F, horiz=TRUE, las=2)
dev.off()
?unique
data<-read.delim("past_cpg_goslim_tab", header=T)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
data2<-as.numeric.factor(x=data$Column2)
data3<-cbind(data2, data)
data4<-na.omit(data3)
data5 <-subset(data4, data2 <= 3)
dencpg<-density(unique(data5$data2), na.rm=T)
pdf("PastCpGDensity")
plot(dencpg, xlim=c(-0.1,1.7))
dev.off()
GOslim<-tapply(data5$data2, data5$GOSlim_bin, mean)
pdf("PastGOslim")
par(mar=c(5,15,4,2))
barplot(GOslim, xlim=c(0.5,0.8),xpd=F, horiz=TRUE, las=2)
dev.off()
setwd("~/Documents/Projects/CpG ratio analyses/CpG analysis")
Pdam<-read.delim("t5", header=F)
Pdam2<-na.omit(Pdam)
Pdam3 <-subset(Pdam2, V2 <= 3)
Pdamdencpg<-density(Pdam3$V2, na.rm=T)
PdamGOslim<-tapply(Pdam3$V2, Pdam3$V4, mean)
Past<-read.delim("past_cpg_goslim_tab", header=T)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
Past2<-as.numeric.factor(x=Past$Column2)
Past3<-cbind(Past2, Past)
Past4<-na.omit(Past3)
Past5 <-subset(Past4, Past2 <= 3)
Pastdencpg<-density(Past5$Past2, na.rm=T)
PastGOslim<-tapply(Past5$Past2,Past5$GOSlim_bin, mean)
Maur<-read.delim("t7", header=F)
Maur2<-na.omit(Maur)
Maur3 <-subset(Maur2, V2 <= 3)
Maurdencpg<-density(Maur3$V2, na.rm=T)
MaurGOslim<-tapply(Maur3$V2, Maur3$V4, mean)
plot(Pdamdencpg, xlim=c(-0.1,1.7))
lines(Pastdencpg, col="blue")
lines(Maurdencpg, col="red")
Pdam<-read.delim("t5", header=F)
Pdam2<-na.omit(Pdam)
Pdam3 <-subset(Pdam2, V2 <= 3)
Pdamdencpg<-density(unique(Pdam3$V2), na.rm=T)
PdamGOslim<-tapply(Pdam3$V2, Pdam3$V4, mean)
#P. astreoides
Past<-read.delim("past_cpg_goslim_tab", header=T)
as.numeric.factor <- function(x) {as.numeric(levels(x))[x]}
Past2<-as.numeric.factor(x=Past$Column2)
Past3<-cbind(Past2, Past)
Past4<-na.omit(Past3)
Past5 <-subset(Past4, Past2 <= 3)
Pastdencpg<-density(unique(Past5$Past2), na.rm=T)
PastGOslim<-tapply(Past5$Past2,Past5$GOSlim_bin, mean)
#M. auretenra
Maur<-read.delim("t7", header=F)
Maur2<-na.omit(Maur)
Maur3 <-subset(Maur2, V2 <= 3)
Maurdencpg<-density(unique(Maur3$V2), na.rm=T)
MaurGOslim<-tapply(Maur3$V2, Maur3$V4, mean)
plot(Pdamdencpg, xlim=c(-0.1,1.7))
lines(Pastdencpg, col="blue")
lines(Maurdencpg, col="red")
GO <- as.data.frame(cbind(PdamGOslim, PastGOslim, MaurGOslim))
GO2<-GO[do.call(order,GO),] #makes into matrix ordered by first column
GO3<-cbind(GO2$PdamGOslim, GO2$PastGOslim, GO2$MaurGOslim)
GO4<-t(GO3)
GOnames<-c("DNA metabolism","other metabolic processes",
"protein metabolism", "transport", "cell organization and biogenesis", "other biological processes", "stress response", "death", "RNA metabolism", "cell cycle and proliferation", "cell-cell signalling", "developmental processes", "signal transduction", "undefined", "cell adhesion")
par(mar=c(5,14,4,2))
barplot (GO4,xlim=c(0.5,0.8),beside=TRUE, xpd=F, horiz=TRUE, las=2, col=c(45,55,65),names.arg=GOnames)
setwd("~/Documents/Projects/Coral-CpG-ratio-MS/analyses/Ahya")
?read.delim
Ahya_cpg<-read.delim("Ahya__cpg_GOslim.tab", header=F)
Ahya_cpg<-read.delim("Ahya_cpg_GOslim.tab", header=F)
View(Ahya_cpg)
Ahya_cpg2<-na.omit(Ahya_cpg)
View(Ahya_cpg2)
install.packages("mixtools")
library("mixtools", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
data(Ahya_cpg2)
attach(Ahya_cpg2)
set.seed(100)
out<-normalmixEM(V2, arbvar = FALSE, epsilon = 1e-03)
plot(out)
